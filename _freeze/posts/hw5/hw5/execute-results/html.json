{
  "hash": "b87c538584908bbbc25fba4ea1438d64",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: LS 빅데이터 스쿨 Homework 5\nauthor: Jinii\ndate: '2024-07-30'\ncategories:\n  - bigdata\n---\n\n## 챕터 9-2 설문조사 그래프에서 각 성별 95% 신뢰구간 계산후 그리기\n## norm.ppf() 사용해서 그릴 것. 모분산은 표본 분산을 사용해서 추정\n## 위 아래 수직 막대기로 표시 (아래 그림 참조)\n\n**기존 그래프**\n\n::: {#d72fc180 .cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\nraw_welfare=pd.read_spss('../../Koweps_hpwc14_2019_beta2 (1).sav')\nraw_welfare\n\nwelfare=raw_welfare.copy()\n\nwelfare=welfare.rename(columns = {\"h14_g3\": \"sex\", \"p1402_8aq1\": \"income\"})\nwelfare=welfare[[\"sex\", \"income\"]]\n\nwelfare[\"sex\"] = np.where(welfare[\"sex\"] == 1,'male', 'female')\nwelfare[\"sex\"].value_counts()\n\nwelfare[\"income\"].describe()\nwelfare[\"income\"].isna().sum()\n\nsex_income = welfare.dropna(subset='income') \\\n                    .groupby('sex', as_index=False) \\\n                    .agg(mean_income = ('income', 'mean'))\n                    \nimport seaborn as sns\nsns.barplot(data=sex_income, x=\"sex\", y=\"mean_income\",\n            hue=\"sex\")\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](hw5_files/figure-html/cell-2-output-1.png){width=593 height=429}\n:::\n:::\n\n\n**groupby+add 이용하여 필요한 정보만 모으기**\n\n::: {#86c2f422 .cell execution_count=2}\n``` {.python .cell-code}\nsex_income = welfare.dropna(subset='income') \\\n                    .groupby('sex', as_index=False) \\\n                    .agg(mean_income = ('income', 'mean'),\n                         std_income=('income','std'),\n                         count_income=('income', 'count'))\nsex_income\n```\n\n::: {.cell-output .cell-output-display execution_count=13}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>sex</th>\n      <th>mean_income</th>\n      <th>std_income</th>\n      <th>count_income</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>female</td>\n      <td>186.293096</td>\n      <td>132.057402</td>\n      <td>2245</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>male</td>\n      <td>349.037571</td>\n      <td>217.862254</td>\n      <td>2289</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n**각 성별 loc, scale, 표본갯수 구하기**\n\n::: {#f93ceca6 .cell execution_count=3}\n``` {.python .cell-code}\nfemale_mean=sex_income.iloc[0,1]\nmale_mean=sex_income.iloc[1,1]\nfemale_mean\nmale_mean\n\nfemale_std=sex_income.iloc[0,2]\nmale_std=sex_income.iloc[1,2]\nfemale_std\nmale_std\n\nfemale_count=sex_income.iloc[0,3]\nmale_count=sex_income.iloc[1,3]\nfemale_count\nmale_count\n```\n\n::: {.cell-output .cell-output-display execution_count=14}\n```\nnp.int64(2289)\n```\n:::\n:::\n\n\n**95% 신뢰구간 계산**\n\n::: {#c6d8b19d .cell execution_count=4}\n``` {.python .cell-code}\nfrom scipy.stats import norm\nz_005=norm.ppf(0.95, loc=0, scale=1)\nci_female_1=female_mean - z_005 * female_std / np.sqrt(female_count)\nci_female_2=female_mean + z_005 * female_std / np.sqrt(female_count)\nci_female_1\nci_female_2\n\nci_male_1=male_mean - z_005 * male_std / np.sqrt(male_count)\nci_male_2=male_mean + z_005 * male_std / np.sqrt(male_count)\nci_male_1\nci_male_2\n```\n\n::: {.cell-output .cell-output-display execution_count=15}\n```\nnp.float64(356.5276492215637)\n```\n:::\n:::\n\n\n**신뢰구간을 위 그래프에 검정색 막대기로 표시**\n\n::: {#13556cb7 .cell execution_count=5}\n``` {.python .cell-code}\nsns.barplot(data = sex_income, x = 'sex', y = 'mean_income', hue = 'sex')\nplt.plot([0, 0], [ci_female_1, ci_female_2], color='black')\nplt.plot([1, 1], [ci_male_1, ci_male_2], color='red')\nplt.show()\nplt.clf()\n```\n\n::: {.cell-output .cell-output-display}\n![](hw5_files/figure-html/cell-6-output-1.png){width=593 height=429}\n:::\n\n::: {.cell-output .cell-output-display}\n```\n<Figure size 672x480 with 0 Axes>\n```\n:::\n:::\n\n\n",
    "supporting": [
      "hw5_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}